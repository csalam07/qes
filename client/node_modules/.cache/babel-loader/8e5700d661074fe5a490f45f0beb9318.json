{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\csalam\\\\Downloads\\\\qes\\\\client\\\\src\\\\components\\\\home\\\\comments\\\\CommentCard.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Avatar from '../../Avatar';\nimport { Link } from 'react-router-dom';\nimport moment from 'moment';\nimport UpVote from '../../UpVote';\nimport DownVote from '../../DownVote';\nimport { useSelector, useDispatch } from 'react-redux';\nimport CommentMenu from './CommentMenu';\nimport { updateComment, likeComment, unLikeComment } from '../../../redux/actions/commentAction';\nimport InputComment from '../InputComment';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst CommentCard = _ref => {\n  _s();\n\n  let {\n    children,\n    comment,\n    post,\n    commentId\n  } = _ref;\n  const {\n    auth,\n    theme\n  } = useSelector(state => state);\n  const dispatch = useDispatch();\n  const [content, setContent] = useState('');\n  const [readMore, setReadMore] = useState(false);\n  const [onEdit, setOnEdit] = useState(false);\n  const [isLike, setIsLike] = useState(false);\n  const [downvote, setDownVote] = useState(false);\n  const [loadLike, setLoadLike] = useState(false);\n  const [onReply, setOnReply] = useState(false);\n  useEffect(() => {\n    setContent(comment.content);\n    setIsLike(false);\n    setOnReply(false);\n\n    if (comment.likes.find(like => like._id === auth.user._id)) {\n      setIsLike(true);\n    }\n  }, [comment, auth.user._id]);\n\n  const handleUpdate = () => {\n    if (comment.content !== content) {\n      dispatch(updateComment({\n        comment,\n        post,\n        content,\n        auth\n      }));\n      setOnEdit(false);\n    } else {\n      setOnEdit(false);\n    }\n  };\n\n  const handleLike = async () => {\n    if (loadLike) return;\n    setIsLike(true);\n    setLoadLike(true);\n    await dispatch(likeComment({\n      comment,\n      post,\n      auth\n    }));\n    setLoadLike(false);\n  };\n\n  const handleUnLike = async () => {\n    if (loadLike) return;\n    setIsLike(false);\n    setLoadLike(true);\n    await dispatch(unLikeComment({\n      comment,\n      post,\n      auth\n    }));\n    setLoadLike(false);\n  };\n\n  const handleReply = () => {\n    if (onReply) return setOnReply(false);\n    setOnReply({ ...comment,\n      commentId\n    });\n  };\n\n  const styleCard = {\n    opacity: comment._id ? 1 : 0.5,\n    pointerEvents: comment._id ? 'inherit' : 'none'\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"comment_card mt-2\",\n    style: styleCard,\n    children: [/*#__PURE__*/_jsxDEV(Link, {\n      to: `/profile/${comment.user._id}`,\n      className: \"d-flex text-dark\",\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {\n        src: comment.user.avatar,\n        size: \"small-avatar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h6\", {\n        className: \"mx-1\",\n        children: comment.user.username\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"comment_content\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex-fill\",\n        style: {\n          filter: theme ? 'invert(1)' : 'invert(0)',\n          color: theme ? 'white' : '#111'\n        },\n        children: [onEdit ? /*#__PURE__*/_jsxDEV(\"textarea\", {\n          rows: \"5\",\n          value: content,\n          onChange: e => setContent(e.target.value)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [comment.tag && comment.tag._id !== comment.user._id && /*#__PURE__*/_jsxDEV(Link, {\n            to: `/profile/${comment.tag._id}`,\n            className: \"mr-1\",\n            children: [\"@\", comment.tag.username]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: content.length < 100 ? content : readMore ? content + ' ' : content.slice(0, 100) + '....'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 15\n          }, this), content.length > 100 && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"readMore\",\n            onClick: () => setReadMore(!readMore),\n            children: readMore ? 'Hide content' : 'Read more'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            cursor: 'pointer'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"small\", {\n            className: \"text-muted mr-3\",\n            children: moment(comment.createdAt).fromNow()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n            className: \"font-weight-bold mr-3\",\n            children: [comment.likes.length, \" likes\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this), onEdit ? /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: [/*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"font-weight-bold mr-3\",\n              onClick: handleUpdate,\n              children: \"update\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n              className: \"font-weight-bold mr-3\",\n              onClick: () => setOnEdit(false),\n              children: \"cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true) : /*#__PURE__*/_jsxDEV(\"small\", {\n            className: \"font-weight-bold mr-3\",\n            onClick: handleReply,\n            children: onReply ? 'cancel' : 'reply'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex align-items-center mx-2\",\n        style: {\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(CommentMenu, {\n          post: post,\n          comment: comment,\n          setOnEdit: setOnEdit\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(UpVote, {\n          isLike: isLike,\n          handleLike: handleLike,\n          handleUnLike: handleUnLike\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(DownVote, {\n          isLike: isLike,\n          handleLike: handleLike,\n          handleUnLike: handleUnLike\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 162,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), onReply && /*#__PURE__*/_jsxDEV(InputComment, {\n      post: post,\n      onReply: onReply,\n      setOnReply: setOnReply,\n      children: /*#__PURE__*/_jsxDEV(Link, {\n        to: `/profile/${onReply.user._id}`,\n        className: \"mr-1\",\n        children: [\"@\", onReply.user.username, \":\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 9\n    }, this), children]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CommentCard, \"RWQy7kUZR01dhAnTSBfY4jInC6c=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = CommentCard;\nexport default CommentCard;\n\nvar _c;\n\n$RefreshReg$(_c, \"CommentCard\");","map":{"version":3,"sources":["C:/Users/csalam/Downloads/qes/client/src/components/home/comments/CommentCard.js"],"names":["React","useState","useEffect","Avatar","Link","moment","UpVote","DownVote","useSelector","useDispatch","CommentMenu","updateComment","likeComment","unLikeComment","InputComment","CommentCard","children","comment","post","commentId","auth","theme","state","dispatch","content","setContent","readMore","setReadMore","onEdit","setOnEdit","isLike","setIsLike","downvote","setDownVote","loadLike","setLoadLike","onReply","setOnReply","likes","find","like","_id","user","handleUpdate","handleLike","handleUnLike","handleReply","styleCard","opacity","pointerEvents","avatar","username","filter","color","e","target","value","tag","length","slice","cursor","createdAt","fromNow"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Avatar from '../../Avatar';\r\nimport { Link } from 'react-router-dom';\r\nimport moment from 'moment';\r\n\r\nimport UpVote from '../../UpVote';\r\nimport DownVote from '../../DownVote';\r\nimport { useSelector, useDispatch } from 'react-redux';\r\nimport CommentMenu from './CommentMenu';\r\nimport {\r\n  updateComment,\r\n  likeComment,\r\n  unLikeComment,\r\n} from '../../../redux/actions/commentAction';\r\nimport InputComment from '../InputComment';\r\n\r\nconst CommentCard = ({ children, comment, post, commentId }) => {\r\n  const { auth, theme } = useSelector((state) => state);\r\n  const dispatch = useDispatch();\r\n\r\n  const [content, setContent] = useState('');\r\n  const [readMore, setReadMore] = useState(false);\r\n\r\n  const [onEdit, setOnEdit] = useState(false);\r\n  const [isLike, setIsLike] = useState(false);\r\n  const [downvote, setDownVote] = useState(false);\r\n  const [loadLike, setLoadLike] = useState(false);\r\n\r\n  const [onReply, setOnReply] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setContent(comment.content);\r\n    setIsLike(false);\r\n    setOnReply(false);\r\n    if (comment.likes.find((like) => like._id === auth.user._id)) {\r\n      setIsLike(true);\r\n    }\r\n  }, [comment, auth.user._id]);\r\n\r\n  const handleUpdate = () => {\r\n    if (comment.content !== content) {\r\n      dispatch(updateComment({ comment, post, content, auth }));\r\n      setOnEdit(false);\r\n    } else {\r\n      setOnEdit(false);\r\n    }\r\n  };\r\n\r\n  const handleLike = async () => {\r\n    if (loadLike) return;\r\n    setIsLike(true);\r\n\r\n    setLoadLike(true);\r\n    await dispatch(likeComment({ comment, post, auth }));\r\n    setLoadLike(false);\r\n  };\r\n\r\n  const handleUnLike = async () => {\r\n    if (loadLike) return;\r\n    setIsLike(false);\r\n\r\n    setLoadLike(true);\r\n    await dispatch(unLikeComment({ comment, post, auth }));\r\n    setLoadLike(false);\r\n  };\r\n\r\n  const handleReply = () => {\r\n    if (onReply) return setOnReply(false);\r\n    setOnReply({ ...comment, commentId });\r\n  };\r\n\r\n  const styleCard = {\r\n    opacity: comment._id ? 1 : 0.5,\r\n    pointerEvents: comment._id ? 'inherit' : 'none',\r\n  };\r\n\r\n  return (\r\n    <div className=\"comment_card mt-2\" style={styleCard}>\r\n      <Link to={`/profile/${comment.user._id}`} className=\"d-flex text-dark\">\r\n        <Avatar src={comment.user.avatar} size=\"small-avatar\" />\r\n        <h6 className=\"mx-1\">{comment.user.username}</h6>\r\n      </Link>\r\n\r\n      <div className=\"comment_content\">\r\n        <div\r\n          className=\"flex-fill\"\r\n          style={{\r\n            filter: theme ? 'invert(1)' : 'invert(0)',\r\n            color: theme ? 'white' : '#111',\r\n          }}\r\n        >\r\n          {onEdit ? (\r\n            <textarea\r\n              rows=\"5\"\r\n              value={content}\r\n              onChange={(e) => setContent(e.target.value)}\r\n            />\r\n          ) : (\r\n            <div>\r\n              {comment.tag && comment.tag._id !== comment.user._id && (\r\n                <Link to={`/profile/${comment.tag._id}`} className=\"mr-1\">\r\n                  @{comment.tag.username}\r\n                </Link>\r\n              )}\r\n              <span>\r\n                {content.length < 100\r\n                  ? content\r\n                  : readMore\r\n                  ? content + ' '\r\n                  : content.slice(0, 100) + '....'}\r\n              </span>\r\n              {content.length > 100 && (\r\n                <span\r\n                  className=\"readMore\"\r\n                  onClick={() => setReadMore(!readMore)}\r\n                >\r\n                  {readMore ? 'Hide content' : 'Read more'}\r\n                </span>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          <div style={{ cursor: 'pointer' }}>\r\n            <small className=\"text-muted mr-3\">\r\n              {moment(comment.createdAt).fromNow()}\r\n            </small>\r\n\r\n            <small className=\"font-weight-bold mr-3\">\r\n              {comment.likes.length} likes\r\n            </small>\r\n\r\n            {onEdit ? (\r\n              <>\r\n                <small className=\"font-weight-bold mr-3\" onClick={handleUpdate}>\r\n                  update\r\n                </small>\r\n                <small\r\n                  className=\"font-weight-bold mr-3\"\r\n                  onClick={() => setOnEdit(false)}\r\n                >\r\n                  cancel\r\n                </small>\r\n              </>\r\n            ) : (\r\n              <small className=\"font-weight-bold mr-3\" onClick={handleReply}>\r\n                {onReply ? 'cancel' : 'reply'}\r\n              </small>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        <div\r\n          className=\"d-flex align-items-center mx-2\"\r\n          style={{ cursor: 'pointer' }}\r\n        >\r\n          <CommentMenu post={post} comment={comment} setOnEdit={setOnEdit} />\r\n          <UpVote\r\n            isLike={isLike}\r\n            handleLike={handleLike}\r\n            handleUnLike={handleUnLike}\r\n          />\r\n          <DownVote\r\n            isLike={isLike}\r\n            handleLike={handleLike}\r\n            handleUnLike={handleUnLike}\r\n          />\r\n        </div>\r\n      </div>\r\n\r\n      {onReply && (\r\n        <InputComment post={post} onReply={onReply} setOnReply={setOnReply}>\r\n          <Link to={`/profile/${onReply.user._id}`} className=\"mr-1\">\r\n            @{onReply.user.username}:\r\n          </Link>\r\n        </InputComment>\r\n      )}\r\n\r\n      {children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CommentCard;\r\n"]},"metadata":{},"sourceType":"module"}